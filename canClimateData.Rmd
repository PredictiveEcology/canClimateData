---
title: "canClimateData"
author: "Alex Chubaty"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    df_print: paged
    keep_md: yes
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE, warning = FALSE, results = "hold")

if (!require("Require", quietly = TRUE)) {
  install.packages("Require")
  library(Require)
}
Require("SpaDES.core", require = FALSE, upgrade = FALSE)
Require(c("knitr", "kableExtra", "magrittr"))
```

# Overview

Prepare Canadian historic and projected climate data for use with LandR.CS and fireSense.

Currently supports study areas in AB, BC, SK, MB, ON, QR, NT, and YT, for the following climate scenarios:

```{r climateStudyAreas, eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE}
#csv <- file.path("modules", "canClimateData", "data", "climateDataURLs.csv")
csv <- file.path("data", "climateDataURLs.csv")
df_climate <- read.csv(csv, stringsAsFactors = FALSE)
df_climate <- subset(df_climate, select = c("studyArea", "GCM", "SSP")) |> na.omit() |> unique()
df_climate <- df_climate[order(df_climate$studyArea, df_climate$GCM, df_climate$SSP), ]
g <- which(as.integer(as.factor(df_climate$studyArea)) %% 2 == 0) ## alternate by group
knitr::kable(df_climate, row.names = FALSE) %>% 
  kable_styling(full_width = FALSE) %>% 
  row_spec(g, background = "#f0f0f0")
```

# Parameters

Provide a summary of user-visible parameters.

```{r moduleParams, eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE}
df_params <- SpaDES.core::moduleParams("canClimateData", "..")
knitr::kable(df_params)
```

# Events

This moduel consists of a single `init` event that performs all the data preparation.

# Data dependencies

## Input data

How to obtain input data, and a description of the data required by the module.
If `sourceURL` is specified, `downloadData("canClimateData", "..")` may be sufficient.

```{r moduleInputs, eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE}
df_inputs <- SpaDES.core::moduleInputs("canClimateData", "..")
knitr::kable(df_inputs)
```

## Output data

Description of the module outputs.

```{r moduleOutputs, eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE}
df_outputs <- SpaDES.core::moduleOutputs("canClimateData", "..")
knitr::kable(df_outputs)
```

# Links to other modules

Originally developed to provide inputs to `gmcsDataPrep` (for use with climate-sensitive LandR Biomass projections; see `Biomass_core`) and the `fireSense` suite of modules.
